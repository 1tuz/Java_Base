
#hibernate #springboot 
#### **Spring Boot**

1. **Основы Spring Boot:**
    
    - Spring Boot автоматизирует конфигурацию Spring Framework. Главное его преимущество — минимизация ручной настройки через использование аннотаций и встроенных инструментов.
    - Приложение запускается через встроенный сервер (Tomcat, Jetty или Undertow) с помощью метода `SpringApplication.run()`.
2. **Основные аннотации:**
    
    - **`@SpringBootApplication`:** Комбинирует аннотации `@Configuration`, `@EnableAutoConfiguration` и `@ComponentScan`.
    - **`@Component`, `@Service`, `@Repository`:** Для регистрации классов как бинов в контексте Spring.
    - **`@Configuration`:** Указывает, что класс содержит конфигурацию бинов.
    - **`@Bean`:** Создает и регистрирует бины вручную.
3. **Работа с конфигурациями:**
    
    - Конфигурационные файлы: `application.properties` или `application.yml`.
    - Профили: Позволяют переключать конфигурации для разных сред (`dev`, `test`, `prod`) через `@Profile`.
    - Используй `@Value` или `@ConfigurationProperties` для внедрения параметров из конфигурационных файлов.
4. **Spring Data и работа с базами данных:**
    
    - Используй Spring Data JPA для упрощения работы с Hibernate. Репозитории предоставляют методы для стандартных операций: `save`, `findById`, `delete`.
    - Кастомные запросы можно писать через методы с именами, отражающими логику: `findByNameAndStatus(String name, String status)`.
    - Более сложные запросы создаются с использованием JPQL или Native Query через аннотацию `@Query`.
5. **Транзакционность:**
    
    - **`@Transactional`:** Управляет транзакциями. Уровни изоляции (`Isolation`) и propagation (`Propagation`) определяют, как транзакции взаимодействуют друг с другом.
    - Изоляция:
        - `READ_UNCOMMITTED`: Минимальная защита от конфликтов.
        - `READ_COMMITTED`: Защита от "грязных" чтений.
        - `REPEATABLE_READ`: Защита от "фантомных" записей.
        - `SERIALIZABLE`: Максимальная защита, но снижает производительность.
    - Rollback автоматически выполняется при возникновении `RuntimeException`.
6. **Spring Security:**
    
    - Защита приложения через аутентификацию и авторизацию.
    - Настраивается через цепочку фильтров или аннотации (`@EnableWebSecurity`, `@PreAuthorize`, `@Secured`).
    - Можно интегрировать с JWT, OAuth2 или внешними сервисами, такими как Keycloak.
7. **Работа с REST API:**
    
    - Аннотации:
        - **`@RestController`:** Объединяет `@Controller` и `@ResponseBody`.
        - **`@RequestMapping`:** Задает путь для обработки HTTP-запросов.
        - **`@GetMapping`, `@PostMapping`:** Для указания методов запросов.
    - Обработка ошибок через `@ExceptionHandler` и глобальные контроллеры ошибок (`@ControllerAdvice`).

---

#### **Hibernate**

1. **Основы работы с Hibernate:**
    
    - Hibernate — это ORM (Object-Relational Mapping) фреймворк. Он автоматически преобразует объекты Java в записи базы данных и обратно.
    - Используй аннотации:
        - **`@Entity`:** Указывает, что класс представляет таблицу в базе данных.
        - **`@Table`:** Позволяет настраивать параметры таблицы (например, имя).
        - **`@Id`, `@GeneratedValue`:** Обозначают первичный ключ и стратегию его генерации (`IDENTITY`, `SEQUENCE`).
2. **Связи между сущностями:**
    
    - **`@OneToOne`:** Один к одному.
    - **`@OneToMany` и `@ManyToOne`:** Один ко многим и многие к одному.
    - **`@ManyToMany`:** Многие ко многим. Используй промежуточные таблицы для оптимизации.
    - Ленивая загрузка (`LAZY`) экономит ресурсы, загружая связанные данные только при необходимости.
3. **Проблемы и их решения:**
    
    - **n+1 проблема:** Возникает, когда Hibernate выполняет слишком много запросов для загрузки связанных сущностей. Решение — `JOIN FETCH` или `EntityGraph`.
    - **Кэширование:** Второй уровень кэша (например, с использованием Ehcache) позволяет сократить количество запросов к базе.
    - **Оптимизация запросов:** Используй индексы в таблицах и избегай неоптимальных конструкций.
4. **Кэширование:**
    
    - Первый уровень кэша: Включен по умолчанию для каждого `Session`.
    - Второй уровень кэша: Для глобального хранения данных, поддерживает кэши, такие как Ehcache, Hazelcast.
5. **Работа с транзакциями:**
    
    - Управляй транзакциями через `Session` или интеграцию с Spring (`@Transactional`).
    - Понимай состояние объектов Hibernate:
        - **Transient:** Объект не привязан к `Session`.
        - **Persistent:** Объект управляется Hibernate.
        - **Detached:** Объект выходит из контекста Hibernate.
