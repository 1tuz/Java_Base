**@Transactional** — это аннотация Spring, которая управляет транзакциями для методов или классов. Она используется для того, чтобы операции над базой данных (CRUD) выполнялись как единое целое. Если что-то пошло не так, изменения откатываются.

Как работает @Transactional под капотом:
1. AOP (Aspect-Oriented Programming): Spring применяет аспектно-ориентированное программирование, чтобы «обернуть» методы, помеченные аннотацией **@Transactional**, дополнительной логикой.
2. Прокси:
	   1) Spring создаёт **прокси-объект** для класса, где используется **@Transactional**.
	   2) Этот прокси перехватывает вызовы методов и начинает/коммитит/откатывает транзакции.
	   3) Прокси определяет: Когда начать транзакцию. Когда зафиксировать (commit) или откатить (rollback) изменения.
3. Подключение менеджера транзакций: Прокси взаимодействует с **TransactionManager**, который управляет соединением с базой данных.

Ключевые моменты работы:
1. Начало транзакции: Когда вызывается метод с **@Transactional**, Spring начинает транзакцию.
2. Коммит: Если метод завершился успешно (без исключений), транзакция фиксируется в базе данных.
3. Роллбэк: Если выбрасывается исключение (особенно **RuntimeException** или **Error**), изменения откатываются.

Уровни изоляции транзакций
Уровни изоляции определяют, как одна транзакция видит изменения, сделанные другой. Мы можете указать уровень изоляции в **@Transactional(isolation = ...)**.
Примеры:
1. **READ_UNCOMMITTED:** Видит изменения, которые ещё не зафиксированы (грязное чтение).
2. **READ_COMMITTED:** Видит только зафиксированные изменения (грязное чтение исключено).
3. **REPEATABLE_READ:** Гарантирует, что данные не изменятся в ходе транзакции. (предотвращает фантомные изменения, но не всегда)
4. **SERIALIZABLE:** Максимальная изоляция, транзакции выполняются последовательно. (медленно, но безопасно).

Propagation (распространение транзакций)
Определяет, как методы с **@Transactional** взаимодействуют друг с другом:
1. REQUIRED (по умолчанию): Если транзакция уже есть, метод использует её; иначе создаёт новую.
2. REQUIRES_NEW: Всегда создаёт новую транзакцию, приостанавливая текущую (если есть).\
3. SUPPORTS: Использует текущую транзакцию, если она есть, иначе работает без транзакции.
4. MANDATORY: Требует существующей транзакции, иначе выбрасывает исключение.
5. NOT_SUPPORTED: Метод выполняется без транзакции, приостанавливая текущую.
6. NEVER: Метод выполняется без транзакции. Если транзакция есть, выбрасывается исключение.
7. NESTED: Создаёт вложенную транзакцию, которая может быть откатана отдельно от основной.

Итог:
1. Управляет транзакциями автоматически, упрощая работу.
2. Использует AOP и прокси для оборачивания методов.
3. Позволяет настроить поведение транзакций через уровни изоляции и propagation.
4. Поддерживает откаты при ошибках, но требует правильного использования.