Как хранятся данные в Kafka:
1. Лог-файлы:
	1) Данные хранятся на диске в виде лог-файлов.
	2) Каждый топик делится на партиции, и для каждой партиции создается отдельный лог-файл.
2. Структура хранения:
	1) Сообщения в партиции записываются последовательно, без изменений.
	2) Каждое сообщение имеет **смещение** (offset) — уникальный номер, который определяет его порядок.
3. Репликация:
	1) Для повышения надежности данные дублируются (реплицируются) между брокерами.
	2) Один брокер становится **лидером** партиции, а остальные — **фолловерами**. Лидер обрабатывает все чтение и запись.
4. Удаление старых данных:
	1) Kafka настроена на удаление данных, чтобы не переполнять диск:
		- **Retention policy:** Сообщения удаляются после указанного времени (например, 7 дней).
		- **Size-based policy:** Удаление, если данные превышают заданный объем.
5. Сжатие данных:
	1) Для экономии места Kafka поддерживает сжатие (gzip, snappy, zstd).


Механизм хранения данных:
1. Производитель (Producer):
	1) Отправляет сообщения в определенный топик.
	2) Сообщения распределяются по партициям (обычно на основе ключа или случайным образом).
2. Диск и память:
	1) Kafka сначала записывает данные в оперативную память (RAM) и затем сбрасывает их на диск.
	2) Использование **Zero Copy** позволяет передавать данные из диска в сеть без копирования в оперативную память.
2. Читатели (Consumers):
	1) Сообщения читаются с диска, начиная с указанного смещения (offset).
	2) Offset контролируется потребителем, что позволяет возвращаться к старым данным.


Сценарии использования:
1. Обработка потоков данных (Streaming):
   Kafka передает большие объемы данных в реальном времени, например, для логов, метрик или событий.
2. Интеграция микросервисов:
   Kafka используется как посредник для передачи сообщений между сервисами.
3. Хранилище событий (Event Sourcing):
   Kafka сохраняет последовательность событий, что позволяет восстанавливать состояния систем.
4. Аналитика в реальном времени:
   Сбор данных (кликов, транзакций) и их обработка для аналитики в режиме реального времени.