Данные в Kafka распределяются по партициям **с помощью ключа записи** или **случайным образом**, если ключ не указан.

Партиция — это "кусочек" внутри топика, который хранит часть всех сообщений:
1. Каждая партиция упорядочена, и сообщения внутри неё имеют уникальные **offset'ы** (номера).
2. Партиции помогают распределять нагрузку между серверами и позволяют обрабатывать данные параллельно.

Как распределяются данные:
1. С ключом (Partition Key) - если мы указываем ключ для записи, Kafka использует хэш-функцию:
	1) Это гарантирует, что все сообщения с одинаковым ключом попадут в одну и ту же партицию.
	   
	   Например:
	   Ключ `"user123"` всегда будет направляться в одну и ту же партицию.
2. Без ключа:
	1) Kafka равномерно распределяет сообщения по партициям (например, по кругу).
	2) Это обеспечивает равномерную загрузку всех партиций.

Пример:
У нас есть топик с 3 партициями: **Partition 0**, **Partition 1**, **Partition 2**.

**С ключом**:
1. Сообщение с ключом `"apple"` всегда будет направляться в **Partition 0**.
2. Сообщение с ключом `"banana"` — в **Partition 1**.

**Без ключа**:
1. Kafka распределяет сообщения случайно: одно попадёт в **Partition 0**, другое в **Partition 1**, следующее — в **Partition 2**.


Зачем это нужно:
1. Гарантия порядка - сообщения с одним ключом всегда попадают в одну партицию и сохраняют порядок. Например, все заказы пользователя `"user123"` будут обработаны последовательно.
2. Масштабируемость - разделение на партиции позволяет обрабатывать данные параллельно несколькими узлами.
3. Гибкость - использование ключа помогает группировать связанные данные в одной партиции.

Итог:
Распределение данных по партициям зависит от ключа. Если ключ указан, Kafka использует хэширование. Если ключа нет, распределение происходит случайным образом. Это помогает оптимально использовать ресурсы и обрабатывать данные эффективно.